["^ ","~:resource-id",["~:shadow.build.npm/resource","node_modules/diffie-hellman/lib/generatePrime.js"],"~:js","shadow$provide[206]=function(S,A,V,q){function F(D){if(null!==H)var C=H;else{C=[2];for(var I=1,M=3;1048576>M;M+=2){for(var P=Math.ceil(Math.sqrt(M)),J=0;J<I&&C[J]<=P&&0!==M%C[J];J++);I!==J&&C[J]<=P||(C[I++]=M)}H=C}for(I=0;I<C.length;I++)if(0===D.modn(C[I]))if(0===D.cmpn(C[I]))break;else return!1;return!0}function G(D){var C=e.mont(D);return 0===l.toRed(C).redPow(D.subn(1)).fromRed().cmpn(1)}function r(D,C){if(16>D)return 2===C||5===C?new e([140,123]):new e([140,39]);C=new e(C);for(var I,M;;){for(I=\nnew e(y(Math.ceil(D/8)));I.bitLength()>D;)I.ishrn(1);I.isEven()&&I.iadd(n);I.testn(1)||I.iadd(l);if(!C.cmp(l))for(;I.mod(u).cmp(B);)I.iadd(E);else if(!C.cmp(h))for(;I.mod(k).cmp(t);)I.iadd(E);M=I.shrn(1);if(F(M)&&F(I)&&G(M)&&G(I)&&p.test(M)&&p.test(I))return I}}var y=A(112);V.exports=r;r.simpleSieve=F;r.fermatTest=G;var e=A(203),u=new e(24),p=new (A(205)),n=new e(1),l=new e(2),h=new e(5);new e(16);new e(8);var k=new e(10),t=new e(3);new e(7);var B=new e(11),E=new e(4);new e(12);var H=null}","~:source","shadow$provide[206] = function(global,require,module,exports) {\nvar randomBytes = require('randombytes');\nmodule.exports = findPrime;\nfindPrime.simpleSieve = simpleSieve;\nfindPrime.fermatTest = fermatTest;\nvar BN = require('bn.js');\nvar TWENTYFOUR = new BN(24);\nvar MillerRabin = require('miller-rabin');\nvar millerRabin = new MillerRabin();\nvar ONE = new BN(1);\nvar TWO = new BN(2);\nvar FIVE = new BN(5);\nvar SIXTEEN = new BN(16);\nvar EIGHT = new BN(8);\nvar TEN = new BN(10);\nvar THREE = new BN(3);\nvar SEVEN = new BN(7);\nvar ELEVEN = new BN(11);\nvar FOUR = new BN(4);\nvar TWELVE = new BN(12);\nvar primes = null;\n\nfunction _getPrimes() {\n  if (primes !== null)\n    return primes;\n\n  var limit = 0x100000;\n  var res = [];\n  res[0] = 2;\n  for (var i = 1, k = 3; k < limit; k += 2) {\n    var sqrt = Math.ceil(Math.sqrt(k));\n    for (var j = 0; j < i && res[j] <= sqrt; j++)\n      if (k % res[j] === 0)\n        break;\n\n    if (i !== j && res[j] <= sqrt)\n      continue;\n\n    res[i++] = k;\n  }\n  primes = res;\n  return res;\n}\n\nfunction simpleSieve(p) {\n  var primes = _getPrimes();\n\n  for (var i = 0; i < primes.length; i++)\n    if (p.modn(primes[i]) === 0) {\n      if (p.cmpn(primes[i]) === 0) {\n        return true;\n      } else {\n        return false;\n      }\n    }\n\n  return true;\n}\n\nfunction fermatTest(p) {\n  var red = BN.mont(p);\n  return TWO.toRed(red).redPow(p.subn(1)).fromRed().cmpn(1) === 0;\n}\n\nfunction findPrime(bits, gen) {\n  if (bits < 16) {\n    // this is what openssl does\n    if (gen === 2 || gen === 5) {\n      return new BN([0x8c, 0x7b]);\n    } else {\n      return new BN([0x8c, 0x27]);\n    }\n  }\n  gen = new BN(gen);\n\n  var num, n2;\n\n  while (true) {\n    num = new BN(randomBytes(Math.ceil(bits / 8)));\n    while (num.bitLength() > bits) {\n      num.ishrn(1);\n    }\n    if (num.isEven()) {\n      num.iadd(ONE);\n    }\n    if (!num.testn(1)) {\n      num.iadd(TWO);\n    }\n    if (!gen.cmp(TWO)) {\n      while (num.mod(TWENTYFOUR).cmp(ELEVEN)) {\n        num.iadd(FOUR);\n      }\n    } else if (!gen.cmp(FIVE)) {\n      while (num.mod(TEN).cmp(THREE)) {\n        num.iadd(FOUR);\n      }\n    }\n    n2 = num.shrn(1);\n    if (simpleSieve(n2) && simpleSieve(num) &&\n      fermatTest(n2) && fermatTest(num) &&\n      millerRabin.test(n2) && millerRabin.test(num)) {\n      return num;\n    }\n  }\n\n}\n\n};","~:removed-requires",["~#set",[]],"~:actual-requires",["^5",["~$module$node_modules$diffie_hellman$node_modules$bn_js$lib$bn","~$shadow.js","~$module$node_modules$miller_rabin$lib$mr","~$module$node_modules$randombytes$browser"]],"~:properties",["^5",["fermatTest","simpleSieve"]],"~:compiled-at",1695041440843,"~:source-map-json","{\n\"version\":3,\n\"file\":\"module$node_modules$diffie_hellman$lib$generatePrime.js\",\n\"lineCount\":2,\n\"mappings\":\"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\",\n\"sources\":[\"node_modules/diffie-hellman/lib/generatePrime.js\"],\n\"sourcesContent\":[\"shadow$provide[206] = function(global,require,module,exports) {\\nvar randomBytes = require('randombytes');\\nmodule.exports = findPrime;\\nfindPrime.simpleSieve = simpleSieve;\\nfindPrime.fermatTest = fermatTest;\\nvar BN = require('bn.js');\\nvar TWENTYFOUR = new BN(24);\\nvar MillerRabin = require('miller-rabin');\\nvar millerRabin = new MillerRabin();\\nvar ONE = new BN(1);\\nvar TWO = new BN(2);\\nvar FIVE = new BN(5);\\nvar SIXTEEN = new BN(16);\\nvar EIGHT = new BN(8);\\nvar TEN = new BN(10);\\nvar THREE = new BN(3);\\nvar SEVEN = new BN(7);\\nvar ELEVEN = new BN(11);\\nvar FOUR = new BN(4);\\nvar TWELVE = new BN(12);\\nvar primes = null;\\n\\nfunction _getPrimes() {\\n  if (primes !== null)\\n    return primes;\\n\\n  var limit = 0x100000;\\n  var res = [];\\n  res[0] = 2;\\n  for (var i = 1, k = 3; k < limit; k += 2) {\\n    var sqrt = Math.ceil(Math.sqrt(k));\\n    for (var j = 0; j < i && res[j] <= sqrt; j++)\\n      if (k % res[j] === 0)\\n        break;\\n\\n    if (i !== j && res[j] <= sqrt)\\n      continue;\\n\\n    res[i++] = k;\\n  }\\n  primes = res;\\n  return res;\\n}\\n\\nfunction simpleSieve(p) {\\n  var primes = _getPrimes();\\n\\n  for (var i = 0; i < primes.length; i++)\\n    if (p.modn(primes[i]) === 0) {\\n      if (p.cmpn(primes[i]) === 0) {\\n        return true;\\n      } else {\\n        return false;\\n      }\\n    }\\n\\n  return true;\\n}\\n\\nfunction fermatTest(p) {\\n  var red = BN.mont(p);\\n  return TWO.toRed(red).redPow(p.subn(1)).fromRed().cmpn(1) === 0;\\n}\\n\\nfunction findPrime(bits, gen) {\\n  if (bits < 16) {\\n    // this is what openssl does\\n    if (gen === 2 || gen === 5) {\\n      return new BN([0x8c, 0x7b]);\\n    } else {\\n      return new BN([0x8c, 0x27]);\\n    }\\n  }\\n  gen = new BN(gen);\\n\\n  var num, n2;\\n\\n  while (true) {\\n    num = new BN(randomBytes(Math.ceil(bits / 8)));\\n    while (num.bitLength() > bits) {\\n      num.ishrn(1);\\n    }\\n    if (num.isEven()) {\\n      num.iadd(ONE);\\n    }\\n    if (!num.testn(1)) {\\n      num.iadd(TWO);\\n    }\\n    if (!gen.cmp(TWO)) {\\n      while (num.mod(TWENTYFOUR).cmp(ELEVEN)) {\\n        num.iadd(FOUR);\\n      }\\n    } else if (!gen.cmp(FIVE)) {\\n      while (num.mod(TEN).cmp(THREE)) {\\n        num.iadd(FOUR);\\n      }\\n    }\\n    n2 = num.shrn(1);\\n    if (simpleSieve(n2) && simpleSieve(num) &&\\n      fermatTest(n2) && fermatTest(num) &&\\n      millerRabin.test(n2) && millerRabin.test(num)) {\\n      return num;\\n    }\\n  }\\n\\n}\\n\\n};\"],\n\"names\":[\"shadow$provide\",\"global\",\"require\",\"module\",\"exports\",\"simpleSieve\",\"p\",\"primes\",\"res\",\"i\",\"k\",\"limit\",\"sqrt\",\"Math\",\"ceil\",\"j\",\"length\",\"modn\",\"cmpn\",\"fermatTest\",\"red\",\"BN\",\"mont\",\"TWO\",\"toRed\",\"redPow\",\"subn\",\"fromRed\",\"findPrime\",\"bits\",\"gen\",\"num\",\"n2\",\"randomBytes\",\"bitLength\",\"ishrn\",\"isEven\",\"iadd\",\"ONE\",\"testn\",\"cmp\",\"mod\",\"TWENTYFOUR\",\"ELEVEN\",\"FOUR\",\"FIVE\",\"TEN\",\"THREE\",\"shrn\",\"millerRabin\",\"test\",\"MillerRabin\"]\n}\n"]