{
"version":3,
"file":"module$node_modules$viem$_cjs$utils$ccip.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/viem/_cjs/utils/ccip.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$viem$_cjs$utils$ccip\"] = function(global,require,module,exports) {\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ccipFetch = exports.offchainLookup = exports.offchainLookupAbiItem = exports.offchainLookupSignature = void 0;\nconst call_js_1 = require(\"../actions/public/call.js\");\nconst ccip_js_1 = require(\"../errors/ccip.js\");\nconst request_js_1 = require(\"../errors/request.js\");\nconst decodeErrorResult_js_1 = require(\"./abi/decodeErrorResult.js\");\nconst encodeAbiParameters_js_1 = require(\"./abi/encodeAbiParameters.js\");\nconst isAddressEqual_js_1 = require(\"./address/isAddressEqual.js\");\nconst concat_js_1 = require(\"./data/concat.js\");\nconst isHex_js_1 = require(\"./data/isHex.js\");\nconst stringify_js_1 = require(\"./stringify.js\");\nexports.offchainLookupSignature = '0x556f1830';\nexports.offchainLookupAbiItem = {\n    name: 'OffchainLookup',\n    type: 'error',\n    inputs: [\n        {\n            name: 'sender',\n            type: 'address',\n        },\n        {\n            name: 'urls',\n            type: 'string[]',\n        },\n        {\n            name: 'callData',\n            type: 'bytes',\n        },\n        {\n            name: 'callbackFunction',\n            type: 'bytes4',\n        },\n        {\n            name: 'extraData',\n            type: 'bytes',\n        },\n    ],\n};\nasync function offchainLookup(client, { blockNumber, blockTag, data, to, }) {\n    const { args } = (0, decodeErrorResult_js_1.decodeErrorResult)({\n        data,\n        abi: [exports.offchainLookupAbiItem],\n    });\n    const [sender, urls, callData, callbackSelector, extraData] = args;\n    try {\n        if (!(0, isAddressEqual_js_1.isAddressEqual)(to, sender))\n            throw new ccip_js_1.OffchainLookupSenderMismatchError({ sender, to });\n        const result = await ccipFetch({ data: callData, sender, urls });\n        const { data: data_ } = await (0, call_js_1.call)(client, {\n            blockNumber,\n            blockTag,\n            data: (0, concat_js_1.concat)([\n                callbackSelector,\n                (0, encodeAbiParameters_js_1.encodeAbiParameters)([{ type: 'bytes' }, { type: 'bytes' }], [result, extraData]),\n            ]),\n            to,\n        });\n        return data_;\n    }\n    catch (err) {\n        throw new ccip_js_1.OffchainLookupError({\n            callbackSelector,\n            cause: err,\n            data,\n            extraData,\n            sender,\n            urls,\n        });\n    }\n}\nexports.offchainLookup = offchainLookup;\nasync function ccipFetch({ data, sender, urls, }) {\n    let error = new Error('An unknown error occurred.');\n    for (let i = 0; i < urls.length; i++) {\n        const url = urls[i];\n        const method = url.includes('{sender}') || url.includes('{data}') ? 'GET' : 'POST';\n        const body = method === 'POST' ? { data, sender } : undefined;\n        try {\n            const response = await fetch(url.replace('{sender}', sender).replace('{data}', data), {\n                body: JSON.stringify(body),\n                method,\n            });\n            let result;\n            if (response.headers.get('Content-Type')?.startsWith('application/json')) {\n                result = (await response.json()).data;\n            }\n            else {\n                result = (await response.text());\n            }\n            if (!response.ok) {\n                error = new request_js_1.HttpRequestError({\n                    body,\n                    details: (0, stringify_js_1.stringify)(result.error) || response.statusText,\n                    headers: response.headers,\n                    status: response.status,\n                    url,\n                });\n                continue;\n            }\n            if (!(0, isHex_js_1.isHex)(result)) {\n                error = new ccip_js_1.OffchainLookupResponseMalformedError({\n                    result,\n                    url,\n                });\n                continue;\n            }\n            return result;\n        }\n        catch (err) {\n            error = new request_js_1.HttpRequestError({\n                body,\n                details: err.message,\n                url,\n            });\n        }\n    }\n    throw error;\n}\nexports.ccipFetch = ccipFetch;\n//# sourceMappingURL=ccip.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","ccipFetch","data","sender","urls","error","Error","i","length","url","method","includes","body","undefined","response","fetch","replace","JSON","stringify","result","headers","get","startsWith","json","text","ok","isHex_js_1","isHex","ccip_js_1","OffchainLookupResponseMalformedError","request_js_1","HttpRequestError","details","stringify_js_1","statusText","status","err","message","Object","defineProperty","value","offchainLookup","offchainLookupAbiItem","offchainLookupSignature","call_js_1","decodeErrorResult_js_1","encodeAbiParameters_js_1","isAddressEqual_js_1","concat_js_1","name","type","inputs","client","blockNumber","blockTag","to","args","decodeErrorResult","abi","callData","callbackSelector","extraData","isAddressEqual","OffchainLookupSenderMismatchError","data_","call","concat","encodeAbiParameters","OffchainLookupError","cause"]
}
