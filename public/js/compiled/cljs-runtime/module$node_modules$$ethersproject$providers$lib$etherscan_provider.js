shadow$provide.module$node_modules$$ethersproject$providers$lib$etherscan_provider=function(global,require,module$jscomp$0,exports){function getTransactionPostData(transaction){var result={},key;for(key in transaction)if(null!=transaction[key]){var value=transaction[key];if("type"!==key||0!==value)value={type:!0,gasLimit:!0,gasPrice:!0,maxFeePerGs:!0,maxPriorityFeePerGas:!0,nonce:!0,value:!0}[key]?(0,bytes_1.hexValue)((0,bytes_1.hexlify)(value)):"accessList"===key?"["+(0,transactions_1.accessListify)(value).map(function(set){return'{address:"'+
set.address+'",storageKeys:["'+set.storageKeys.join('","')+'"]}'}).join(",")+"]":(0,bytes_1.hexlify)(value),result[key]=value}return result}function getResult(result){if(0==result.status&&("No records found"===result.message||"No transactions found"===result.message))return result.result;if(1!=result.status||"string"!==typeof result.message||!result.message.match(/^OK/)){var error=Error("invalid response");error.result=JSON.stringify(result);0<=(result.result||"").toLowerCase().indexOf("rate limit")&&
(error.throttleRetry=!0);throw error;}return result.result}function getJsonResult(result){if(result&&0==result.status&&"NOTOK"==result.message&&0<=(result.result||"").toLowerCase().indexOf("rate limit")){var error=Error("throttled response");error.result=JSON.stringify(result);error.throttleRetry=!0;throw error;}if("2.0"!=result.jsonrpc)throw error=Error("invalid response"),error.result=JSON.stringify(result),error;if(result.error)throw error=Error(result.error.message||"unknown error"),result.error.code&&
(error.code=result.error.code),result.error.data&&(error.data=result.error.data),error;return result.result}function checkLogTag(blockTag){if("pending"===blockTag)throw Error("pending not supported");return"latest"===blockTag?blockTag:parseInt(blockTag.substring(2),16)}function checkError(method,error,transaction){if("call"===method&&error.code===logger_1.Logger.errors.SERVER_ERROR){var e=error.error;if(e&&(e.message.match(/reverted/i)||e.message.match(/VM execution error/i))){(e=e.data)&&(e="0x"+
e.replace(/^.*0x/i,""));if((0,bytes_1.isHexString)(e))return e;logger.throwError("missing revert data in call exception",logger_1.Logger.errors.CALL_EXCEPTION,{error,data:"0x"})}}e=error.message;error.code===logger_1.Logger.errors.SERVER_ERROR&&(error.error&&"string"===typeof error.error.message?e=error.error.message:"string"===typeof error.body?e=error.body:"string"===typeof error.responseText&&(e=error.responseText));e=(e||"").toLowerCase();e.match(/insufficient funds/)&&logger.throwError("insufficient funds for intrinsic transaction cost",
logger_1.Logger.errors.INSUFFICIENT_FUNDS,{error,method,transaction});e.match(/same hash was already imported|transaction nonce is too low|nonce too low/)&&logger.throwError("nonce has already been used",logger_1.Logger.errors.NONCE_EXPIRED,{error,method,transaction});e.match(/another transaction with same nonce/)&&logger.throwError("replacement fee too low",logger_1.Logger.errors.REPLACEMENT_UNDERPRICED,{error,method,transaction});e.match(/execution failed due to an exception|execution reverted/)&&
logger.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",logger_1.Logger.errors.UNPREDICTABLE_GAS_LIMIT,{error,method,transaction});throw error;}var __extends=this&&this.__extends||function(){var extendStatics=function(d$jscomp$0,b$jscomp$0){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])};return extendStatics(d$jscomp$0,b$jscomp$0)};
return function(d,b){function __(){this.constructor=d}if("function"!==typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new (P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}
function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||
((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=0<t.length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else if(t&&_.label<t[2])_.label=
t[2],_.ops.push(op);else{t[2]&&_.ops.pop();_.trys.pop();continue}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),"throw":verb(1),"return":verb(2)},"function"===typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g};Object.defineProperty(exports,"__esModule",{value:!0});exports.EtherscanProvider=void 0;var bytes_1=
require("module$node_modules$$ethersproject$bytes$lib$index"),properties_1=require("module$node_modules$$ethersproject$properties$lib$index"),transactions_1=require("module$node_modules$$ethersproject$transactions$lib$index"),web_1=require("module$node_modules$$ethersproject$web$lib$index"),formatter_1=require("module$node_modules$$ethersproject$providers$lib$formatter"),logger_1=require("module$node_modules$$ethersproject$logger$lib$index");global=require("module$node_modules$$ethersproject$providers$lib$_version");
var logger=new logger_1.Logger(global.version);require=function(_super){function EtherscanProvider(network,apiKey){network=_super.call(this,network)||this;(0,properties_1.defineReadOnly)(network,"baseUrl",network.getBaseUrl());(0,properties_1.defineReadOnly)(network,"apiKey",apiKey||null);return network}__extends(EtherscanProvider,_super);EtherscanProvider.prototype.getBaseUrl=function(){switch(this.network?this.network.name:"invalid"){case "homestead":return"https://api.etherscan.io";case "goerli":return"https://api-goerli.etherscan.io";
case "sepolia":return"https://api-sepolia.etherscan.io";case "matic":return"https://api.polygonscan.com";case "maticmum":return"https://api-testnet.polygonscan.com";case "arbitrum":return"https://api.arbiscan.io";case "arbitrum-goerli":return"https://api-goerli.arbiscan.io";case "optimism":return"https://api-optimistic.etherscan.io";case "optimism-goerli":return"https://api-goerli-optimistic.etherscan.io"}return logger.throwArgumentError("unsupported network","network",this.network.name)};EtherscanProvider.prototype.getUrl=
function(module,params){var query=Object.keys(params).reduce(function(accum,key){var value=params[key];null!=value&&(accum+="\x26"+key+"\x3d"+value);return accum},"");return this.baseUrl+"/api?module\x3d"+module+query+(this.apiKey?"\x26apikey\x3d"+this.apiKey:"")};EtherscanProvider.prototype.getPostUrl=function(){return this.baseUrl+"/api"};EtherscanProvider.prototype.getPostData=function(module,params){params.module=module;params.apikey=this.apiKey;return params};EtherscanProvider.prototype.fetch=
function(module,params,post){return __awaiter(this,void 0,void 0,function(){var url$jscomp$0,payload,procFunc,connection,payloadStr,result,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:return url$jscomp$0=post?this.getPostUrl():this.getUrl(module,params),payload=post?this.getPostData(module,params):null,procFunc="proxy"===module?getJsonResult:getResult,this.emit("debug",{action:"request",request:url$jscomp$0,provider:this}),connection={url:url$jscomp$0,throttleSlotInterval:1E3,
throttleCallback:function(attempt,url){_this.isCommunityResource()&&(0,formatter_1.showThrottleMessage)();return Promise.resolve(!0)}},payloadStr=null,payload&&(connection.headers={"content-type":"application/x-www-form-urlencoded; charset\x3dUTF-8"},payloadStr=Object.keys(payload).map(function(key){return key+"\x3d"+payload[key]}).join("\x26")),[4,(0,web_1.fetchJson)(connection,payloadStr,procFunc||getJsonResult)];case 1:return result=_a.sent(),this.emit("debug",{action:"response",request:url$jscomp$0,
response:(0,properties_1.deepCopy)(result),provider:this}),[2,result]}})})};EtherscanProvider.prototype.detectNetwork=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return[2,this.network]})})};EtherscanProvider.prototype.perform=function(method,params){return __awaiter(this,void 0,void 0,function(){var _a,postData,error_1,error_2,args,topic0,logs,blocks,i,log,block,_b;return __generator(this,function(_c){switch(_c.label){case 0:_a=method;switch(_a){case "getBlockNumber":return[3,
1];case "getGasPrice":return[3,2];case "getBalance":return[3,3];case "getTransactionCount":return[3,4];case "getCode":return[3,5];case "getStorageAt":return[3,6];case "sendTransaction":return[3,7];case "getBlock":return[3,8];case "getTransaction":return[3,9];case "getTransactionReceipt":return[3,10];case "call":return[3,11];case "estimateGas":return[3,15];case "getLogs":return[3,19];case "getEtherPrice":return[3,26]}return[3,28];case 1:return[2,this.fetch("proxy",{action:"eth_blockNumber"})];case 2:return[2,
this.fetch("proxy",{action:"eth_gasPrice"})];case 3:return[2,this.fetch("account",{action:"balance",address:params.address,tag:params.blockTag})];case 4:return[2,this.fetch("proxy",{action:"eth_getTransactionCount",address:params.address,tag:params.blockTag})];case 5:return[2,this.fetch("proxy",{action:"eth_getCode",address:params.address,tag:params.blockTag})];case 6:return[2,this.fetch("proxy",{action:"eth_getStorageAt",address:params.address,position:params.position,tag:params.blockTag})];case 7:return[2,
this.fetch("proxy",{action:"eth_sendRawTransaction",hex:params.signedTransaction},!0).catch(function(error){return checkError("sendTransaction",error,params.signedTransaction)})];case 8:if(params.blockTag)return[2,this.fetch("proxy",{action:"eth_getBlockByNumber",tag:params.blockTag,boolean:params.includeTransactions?"true":"false"})];throw Error("getBlock by blockHash not implemented");case 9:return[2,this.fetch("proxy",{action:"eth_getTransactionByHash",txhash:params.transactionHash})];case 10:return[2,
this.fetch("proxy",{action:"eth_getTransactionReceipt",txhash:params.transactionHash})];case 11:if("latest"!==params.blockTag)throw Error("EtherscanProvider does not support blockTag for call");postData=getTransactionPostData(params.transaction);postData.module="proxy";postData.action="eth_call";_c.label=12;case 12:return _c.trys.push([12,14,,15]),[4,this.fetch("proxy",postData,!0)];case 13:return[2,_c.sent()];case 14:return error_1=_c.sent(),[2,checkError("call",error_1,params.transaction)];case 15:postData=
getTransactionPostData(params.transaction),postData.module="proxy",postData.action="eth_estimateGas",_c.label=16;case 16:return _c.trys.push([16,18,,19]),[4,this.fetch("proxy",postData,!0)];case 17:return[2,_c.sent()];case 18:return error_2=_c.sent(),[2,checkError("estimateGas",error_2,params.transaction)];case 19:return args={action:"getLogs"},params.filter.fromBlock&&(args.fromBlock=checkLogTag(params.filter.fromBlock)),params.filter.toBlock&&(args.toBlock=checkLogTag(params.filter.toBlock)),params.filter.address&&
(args.address=params.filter.address),params.filter.topics&&0<params.filter.topics.length&&(1<params.filter.topics.length&&logger.throwError("unsupported topic count",logger_1.Logger.errors.UNSUPPORTED_OPERATION,{topics:params.filter.topics}),1===params.filter.topics.length&&(topic0=params.filter.topics[0],"string"===typeof topic0&&66===topic0.length||logger.throwError("unsupported topic format",logger_1.Logger.errors.UNSUPPORTED_OPERATION,{topic0}),args.topic0=topic0)),[4,this.fetch("logs",args)];
case 20:logs=_c.sent(),blocks={},i=0,_c.label=21;case 21:if(!(i<logs.length))return[3,25];log=logs[i];return null!=log.blockHash?[3,24]:null!=blocks[log.blockNumber]?[3,23]:[4,this.getBlock(log.blockNumber)];case 22:if(block=_c.sent())blocks[log.blockNumber]=block.hash;_c.label=23;case 23:log.blockHash=blocks[log.blockNumber],_c.label=24;case 24:return i++,[3,21];case 25:return[2,logs];case 26:if("homestead"!==this.network.name)return[2,0];_b=parseFloat;return[4,this.fetch("stats",{action:"ethprice"})];
case 27:return[2,_b.apply(void 0,[_c.sent().ethusd])];case 28:return[3,29];case 29:return[2,_super.prototype.perform.call(this,method,params)]}})})};EtherscanProvider.prototype.getHistory=function(addressOrName,startBlock,endBlock){return __awaiter(this,void 0,void 0,function(){var params,result,_a,_this=this;return __generator(this,function(_b){switch(_b.label){case 0:return _a={action:"txlist"},[4,this.resolveName(addressOrName)];case 1:return params=(_a.address=_b.sent(),_a.startblock=null==startBlock?
0:startBlock,_a.endblock=null==endBlock?99999999:endBlock,_a.sort="asc",_a),[4,this.fetch("account",params)];case 2:return result=_b.sent(),[2,result.map(function(tx){["contractAddress","to"].forEach(function(key){""==tx[key]&&delete tx[key]});null==tx.creates&&null!=tx.contractAddress&&(tx.creates=tx.contractAddress);var item=_this.formatter.transactionResponse(tx);tx.timeStamp&&(item.timestamp=parseInt(tx.timeStamp));return item})]}})})};EtherscanProvider.prototype.isCommunityResource=function(){return null==
this.apiKey};return EtherscanProvider}(require("module$node_modules$$ethersproject$providers$lib$base_provider").BaseProvider);exports.EtherscanProvider=require}
//# sourceMappingURL=module$node_modules$$ethersproject$providers$lib$etherscan_provider.js.map
