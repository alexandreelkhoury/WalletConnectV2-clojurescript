["^ ","~:resource-id",["~:shadow.build.npm/resource","node_modules/browserify-rsa/index.js"],"~:js","shadow$provide[225]=function(S,A,V,q){function F(u){var p=u.modulus.byteLength();do var n=new y(e(p));while(0<=n.cmp(u.modulus)||!n.umod(u.prime1)||!n.umod(u.prime2));return n}function G(u,p){var n=F(p);var l=n.toRed(y.mont(p.modulus)).redPow(new y(p.publicExponent)).fromRed();n=n.invm(p.modulus);var h=p.modulus.byteLength();u=(new y(u)).mul(l).umod(p.modulus);var k=u.toRed(y.mont(p.prime1)),t=u.toRed(y.mont(p.prime2));u=p.coefficient;l=p.prime1;var B=p.prime2;k=k.redPow(p.exponent1).fromRed();t=\nt.redPow(p.exponent2).fromRed();u=k.isub(t).imul(u).umod(l).imul(B);return t.iadd(u).imul(n).umod(p.modulus).toArrayLike(r,\"be\",h)}var r=A(53).Buffer,y=A(7),e=A(112);G.getr=F;V.exports=G}","~:source","shadow$provide[225] = function(global,require,module,exports) {\nvar Buffer = require('buffer').Buffer;\nvar BN = require('bn.js')\nvar randomBytes = require('randombytes')\n\nfunction blind (priv) {\n  var r = getr(priv)\n  var blinder = r.toRed(BN.mont(priv.modulus)).redPow(new BN(priv.publicExponent)).fromRed()\n  return { blinder: blinder, unblinder: r.invm(priv.modulus) }\n}\n\nfunction getr (priv) {\n  var len = priv.modulus.byteLength()\n  var r\n  do {\n    r = new BN(randomBytes(len))\n  } while (r.cmp(priv.modulus) >= 0 || !r.umod(priv.prime1) || !r.umod(priv.prime2))\n  return r\n}\n\nfunction crt (msg, priv) {\n  var blinds = blind(priv)\n  var len = priv.modulus.byteLength()\n  var blinded = new BN(msg).mul(blinds.blinder).umod(priv.modulus)\n  var c1 = blinded.toRed(BN.mont(priv.prime1))\n  var c2 = blinded.toRed(BN.mont(priv.prime2))\n  var qinv = priv.coefficient\n  var p = priv.prime1\n  var q = priv.prime2\n  var m1 = c1.redPow(priv.exponent1).fromRed()\n  var m2 = c2.redPow(priv.exponent2).fromRed()\n  var h = m1.isub(m2).imul(qinv).umod(p).imul(q)\n  return m2.iadd(h).imul(blinds.unblinder).umod(priv.modulus).toArrayLike(Buffer, 'be', len)\n}\ncrt.getr = getr\n\nmodule.exports = crt\n\n};","~:removed-requires",["~#set",[]],"~:actual-requires",["^5",["~$shadow.js","~$module$node_modules$randombytes$browser","~$module$node_modules$buffer$index","~$module$node_modules$bn_DOT_js$lib$bn"]],"~:properties",["^5",["getr"]],"~:compiled-at",1695041440849,"~:source-map-json","{\n\"version\":3,\n\"file\":\"module$node_modules$browserify_rsa$index.js\",\n\"lineCount\":2,\n\"mappings\":\"AAAAA,cAAA,CAAe,GAAf,CAAA,CAAsB,QAAQ,CAACC,CAAD,CAAQC,CAAR,CAAgBC,CAAhB,CAAuBC,CAAvB,CAAgC,CAW9DC,QAASA,EAAK,CAACC,CAAD,CAAO,CACnB,IAAIC,EAAMD,CAAKE,CAAAA,OAAQC,CAAAA,UAAb,EAEV,GACE,KAAAC,EAAI,IAAIC,CAAJ,CAAOC,CAAA,CAAYL,CAAZ,CAAP,CADN,OAEgC,CAFhC,EAESG,CAAEG,CAAAA,GAAF,CAAMP,CAAKE,CAAAA,OAAX,CAFT,EAEqC,CAACE,CAAEI,CAAAA,IAAF,CAAOR,CAAKS,CAAAA,MAAZ,CAFtC,EAE6D,CAACL,CAAEI,CAAAA,IAAF,CAAOR,CAAKU,CAAAA,MAAZ,CAF9D,CAGA,OAAON,EANY,CASrBO,QAASA,EAAI,CAACC,CAAD,CAAMZ,CAAN,CAAY,CAdnBI,IAAAA,EAAIL,CAAA,CAeWC,CAfX,CAER,KAAA,EADcI,CAAES,CAAAA,KAAF,CAAQR,CAAGS,CAAAA,IAAH,CAcHd,CAdgBE,CAAAA,OAAb,CAAR,CAA+Ba,CAAAA,MAA/B,CAAsC,IAAIV,CAAJ,CAcjCL,CAd6CgB,CAAAA,cAAZ,CAAtC,CAAmEC,CAAAA,OAAnEC,EACd,EAAA,CAAsCd,CAAEe,CAAAA,IAAF,CAanBnB,CAb+BE,CAAAA,OAAZ,CActC,KAAID,EAAMD,CAAKE,CAAAA,OAAQC,CAAAA,UAAb,EACNiB,EAAAA,CAAsBC,CAAZ,IAAIhB,CAAJ,CAAOO,CAAP,CAAYS,EAAAA,GAAZ,CAAuBH,CAAvB,CAAgCV,CAAAA,IAAhC,CAAqCR,CAAKE,CAAAA,OAA1C,CACd,KAAIoB,EAAKF,CAAQP,CAAAA,KAAR,CAAcR,CAAGS,CAAAA,IAAH,CAAQd,CAAKS,CAAAA,MAAb,CAAd,CAAT,CACIc,EAAKH,CAAQP,CAAAA,KAAR,CAAcR,CAAGS,CAAAA,IAAH,CAAQd,CAAKU,CAAAA,MAAb,CAAd,CACLc,EAAAA,CAAOxB,CAAKyB,CAAAA,WACZC,EAAAA,CAAI1B,CAAKS,CAAAA,MACb,KAAIkB,EAAI3B,CAAKU,CAAAA,MACTkB,EAAAA,CAAKN,CAAGP,CAAAA,MAAH,CAAUf,CAAK6B,CAAAA,SAAf,CAA0BZ,CAAAA,OAA1B,EACLa,EAAAA;AAAKP,CAAGR,CAAAA,MAAH,CAAUf,CAAK+B,CAAAA,SAAf,CAA0Bd,CAAAA,OAA1B,EACLe,EAAAA,CAAIJ,CAAGK,CAAAA,IAAH,CAAQH,CAAR,CAAYI,CAAAA,IAAZ,CAAiBV,CAAjB,CAAuBhB,CAAAA,IAAvB,CAA4BkB,CAA5B,CAA+BQ,CAAAA,IAA/B,CAAoCP,CAApC,CACR,OAAOG,EAAGK,CAAAA,IAAH,CAAQH,CAAR,CAAWE,CAAAA,IAAX,CAAuBE,CAAvB,CAAkC5B,CAAAA,IAAlC,CAAuCR,CAAKE,CAAAA,OAA5C,CAAqDmC,CAAAA,WAArD,CAAiEC,CAAjE,CAAyE,IAAzE,CAA+ErC,CAA/E,CAZgB,CAnBzB,IAAIqC,EAAS1C,CAAA,CAAQ,EAAR,CAAkB0C,CAAAA,MAA/B,CACIjC,EAAKT,CAAA,CAAQ,CAAR,CADT,CAEIU,EAAcV,CAAA,CAAQ,GAAR,CA+BlBe,EAAIZ,CAAAA,IAAJ,CAAWA,CAEXF,EAAOC,CAAAA,OAAP,CAAiBa,CApC6C;\",\n\"sources\":[\"node_modules/browserify-rsa/index.js\"],\n\"sourcesContent\":[\"shadow$provide[225] = function(global,require,module,exports) {\\nvar Buffer = require('buffer').Buffer;\\nvar BN = require('bn.js')\\nvar randomBytes = require('randombytes')\\n\\nfunction blind (priv) {\\n  var r = getr(priv)\\n  var blinder = r.toRed(BN.mont(priv.modulus)).redPow(new BN(priv.publicExponent)).fromRed()\\n  return { blinder: blinder, unblinder: r.invm(priv.modulus) }\\n}\\n\\nfunction getr (priv) {\\n  var len = priv.modulus.byteLength()\\n  var r\\n  do {\\n    r = new BN(randomBytes(len))\\n  } while (r.cmp(priv.modulus) >= 0 || !r.umod(priv.prime1) || !r.umod(priv.prime2))\\n  return r\\n}\\n\\nfunction crt (msg, priv) {\\n  var blinds = blind(priv)\\n  var len = priv.modulus.byteLength()\\n  var blinded = new BN(msg).mul(blinds.blinder).umod(priv.modulus)\\n  var c1 = blinded.toRed(BN.mont(priv.prime1))\\n  var c2 = blinded.toRed(BN.mont(priv.prime2))\\n  var qinv = priv.coefficient\\n  var p = priv.prime1\\n  var q = priv.prime2\\n  var m1 = c1.redPow(priv.exponent1).fromRed()\\n  var m2 = c2.redPow(priv.exponent2).fromRed()\\n  var h = m1.isub(m2).imul(qinv).umod(p).imul(q)\\n  return m2.iadd(h).imul(blinds.unblinder).umod(priv.modulus).toArrayLike(Buffer, 'be', len)\\n}\\ncrt.getr = getr\\n\\nmodule.exports = crt\\n\\n};\"],\n\"names\":[\"shadow$provide\",\"global\",\"require\",\"module\",\"exports\",\"getr\",\"priv\",\"len\",\"modulus\",\"byteLength\",\"r\",\"BN\",\"randomBytes\",\"cmp\",\"umod\",\"prime1\",\"prime2\",\"crt\",\"msg\",\"toRed\",\"mont\",\"redPow\",\"publicExponent\",\"fromRed\",\"blinder\",\"invm\",\"blinded\",\"mul\",\"c1\",\"c2\",\"qinv\",\"coefficient\",\"p\",\"q\",\"m1\",\"exponent1\",\"m2\",\"exponent2\",\"h\",\"isub\",\"imul\",\"iadd\",\"unblinder\",\"toArrayLike\",\"Buffer\"]\n}\n"]